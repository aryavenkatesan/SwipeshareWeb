import { useEffect, useState } from "react"
import handMockup from '/assets/handMockup.png'
import { toast } from "./Toast"

function Hero() {
    const [loaded, setLoaded] = useState(false)
    const [email, setEmail] = useState("")
    const [isSubmitting, setIsSubmitting] = useState(false)
    const [showSuccess, setShowSuccess] = useState(false)
    const GOOGLE_SCRIPT_URL = import.meta.env.VITE_GOOGLE_SCRIPT_URL || ""

    useEffect(() => {
        // Slight delay for smoother feel
        const timer = setTimeout(() => setLoaded(true), 100)
        return () => clearTimeout(timer)
    }, [])

    const validateEmail = (email: string) => {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)
    }

    const handleSubmit = async (e: React.FormEvent) => {
        e.preventDefault()

        if (!email) {
            toast({
                title: "Please enter your email address",
                variant: "destructive",
            })
            return
        }

        if (!validateEmail(email)) {
            toast({
                title: "Please enter a valid email address",
                variant: "destructive",
            })
            return
        }

        if (!GOOGLE_SCRIPT_URL) {
            toast({
                title: "Configuration error",
                description: "Unable to submit form. Please try again later.",
                variant: "destructive",
            })
            return
        }

        setIsSubmitting(true)

        try {
            await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    email: email,
                    timestamp: new Date().toISOString(),
                    source: 'hero-waitlist'
                })
            })

            // Show success animation
            setShowSuccess(true)

            toast({
                title: "Welcome to the waitlist!",
                description: "We'll notify you as soon as Swipeshare launches.",
            })

            // Reset after animation
            setTimeout(() => {
                setEmail("")
                setShowSuccess(false)
            }, 1500)

            // eslint-disable-next-line @typescript-eslint/no-unused-vars
        } catch (error) {
            toast({
                title: "Something went wrong",
                description: "Please try again later.",
                variant: "destructive",
            })
        } finally {
            setIsSubmitting(false)
        }
    }

    return (
        <div
            className="relative flex flex-col lg:flex-row place-content-between px-8 lg:pl-16 pt-32 lg:pt-32 lg:pr-0"
            id="home"
            style={{
                background: 'radial-gradient(ellipse 120% 250% at top right, rgba(183,129,225,0.8) 0%, white 60%)',
            }}
        >
            {/* text section */}
            <div
                className={`flex flex-col justify-center flex-1 font-light pb-16 lg:pb-32 transform transition-all duration-1000 ease-out ${loaded ? "opacity-100 translate-y-0" : "opacity-0 translate-y-4"
                    }`}
                style={{ fontFamily: 'Instrument Sans', fontWeight: 400 }}
            >
                <h1 className="text-3xl lg:text-4xl xl:text-5xl pb-8 lg:pb-12 relative inline-block">
                    <span className="relative">
                        No swipe left behind.
                        <svg
                            className="absolute -bottom-2 sm:-bottom-4 left-0 w-full h-[0.45em] overflow-visible"
                            width="1878" height="91" viewBox="0 0 1878 91" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path style={{
                                clipPath: `inset(0 ${loaded ? '0%' : '100%'} 0 0)`,
                                transition: 'clip-path 1s ease-out 0.5s',
                            }}
                                d="M6.99999 76.995C6.99999 76.995 9.44666 76.9817 14.34 76.955C19.2467 76.9283 23.88 76.6683 28.24 76.175C32.5867 75.695 37.16 75.2417 41.96 74.815C46.76 74.375 51.5467 73.8617 56.32 73.275C61.1067 72.675 66.0733 71.9617 71.22 71.135C76.38 70.3083 81.7067 69.515 87.2 68.755C92.6933 67.995 98.4933 67.115 104.6 66.115C110.707 65.115 116.693 64.1883 122.56 63.335C128.413 62.4683 135.187 61.515 142.88 60.475C150.573 59.4217 158.047 58.435 165.3 57.515C172.553 56.595 179.96 55.8017 187.52 55.135C195.093 54.4817 202.367 53.7883 209.34 53.055C216.327 52.3083 223.127 51.655 229.74 51.095C236.34 50.535 243.007 49.895 249.74 49.175C256.46 48.4417 263.273 47.795 270.18 47.235C277.087 46.675 283.993 46.1483 290.9 45.655C297.807 45.175 304.487 44.595 310.94 43.915C317.393 43.235 324.013 42.6283 330.8 42.095C337.6 41.5483 345.633 40.9017 354.9 40.155C364.167 39.4083 373.173 38.6083 381.92 37.755C390.68 36.9017 399.367 36.155 407.98 35.515C416.607 34.875 425.413 34.2883 434.4 33.755C443.4 33.2217 452.68 32.5483 462.24 31.735C471.813 30.935 481.533 30.0683 491.4 29.135C501.253 28.215 511.44 27.255 521.96 26.255C532.467 25.2683 543.113 24.2617 553.9 23.235C564.687 22.2083 575.527 21.175 586.42 20.135C597.313 19.1083 608.26 18.2217 619.26 17.475C630.26 16.7417 642.693 15.9217 656.56 15.015C670.427 14.095 683.473 13.295 695.7 12.615C707.913 11.935 719.28 11.3083 729.8 10.735C740.307 10.1617 750.433 9.46833 760.18 8.655C769.913 7.855 779.54 7.14833 789.06 6.535C798.567 5.92167 807.573 5.48166 816.08 5.21499C824.573 4.96166 832.807 4.64166 840.78 4.25499C848.753 3.88166 856.447 3.615 863.86 3.455C871.287 3.28167 878.033 3.16166 884.1 3.095C890.18 3.02833 895.9 2.84833 901.26 2.555C906.62 2.26166 912.513 2.06833 918.94 1.975C925.38 1.895 931.207 1.78833 936.42 1.655C941.647 1.50833 947.16 1.44833 952.96 1.475C958.76 1.48833 963.847 1.38166 968.22 1.155C972.607 0.928329 976.973 0.721667 981.32 0.535001C985.667 0.361667 990.307 0.254993 995.24 0.214993C1000.17 0.188327 1005.31 0.201661 1010.64 0.254994C1015.97 0.308328 1021.19 0.334996 1026.3 0.334996C1031.41 0.334996 1036.64 0.361664 1042 0.414998C1047.36 0.468331 1052.97 0.548329 1058.84 0.654996C1064.71 0.774996 1071.28 0.874999 1078.56 0.954999C1085.84 1.035 1092.82 1.10833 1099.5 1.175C1106.18 1.24167 1112.96 1.42166 1119.84 1.71499C1126.72 2.00833 1134.05 2.35499 1141.82 2.75499C1149.58 3.16833 1157.5 3.46167 1165.58 3.635C1173.66 3.82167 1182.08 3.955 1190.84 4.035C1199.6 4.12833 1208.53 4.32833 1217.62 4.635C1226.73 4.94167 1236.08 5.16166 1245.68 5.295C1255.29 5.42833 1264.83 5.66167 1274.28 5.995C1283.75 6.32833 1294.35 6.695 1306.1 7.095C1317.85 7.50833 1328.89 7.94833 1339.22 8.415C1349.55 8.88166 1359.57 9.34833 1369.28 9.815C1379 10.2817 1388.35 10.7483 1397.32 11.215C1406.29 11.6817 1415.14 12.2817 1423.86 13.015C1432.58 13.7617 1440.79 14.5417 1448.48 15.355C1456.17 16.1683 1463.45 16.9883 1470.3 17.815C1477.17 18.6283 1483.85 19.4483 1490.36 20.275C1496.87 21.1017 1503.25 21.835 1509.52 22.475C1515.8 23.115 1521.41 23.575 1526.36 23.855C1531.29 24.135 1536.89 24.715 1543.16 25.595C1549.43 26.475 1554.99 27.2217 1559.86 27.835C1564.73 28.435 1569.16 28.9683 1573.16 29.435C1577.15 29.8883 1580.82 30.3217 1584.18 30.735C1587.54 31.1483 1590.67 31.455 1593.56 31.655C1596.47 31.855 1600.73 32.1083 1606.36 32.415C1612 32.7217 1617.4 32.9217 1622.56 33.015C1627.72 33.1083 1631.8 33.3483 1634.8 33.735C1637.8 34.1217 1641.04 34.495 1644.52 34.855C1648 35.215 1651.51 35.5417 1655.06 35.835C1658.59 36.1417 1662.13 36.3617 1665.68 36.495C1669.21 36.615 1673.06 36.7483 1677.22 36.895C1681.38 37.0417 1685.67 37.275 1690.08 37.595C1694.49 37.9017 1698.95 38.3617 1703.46 38.975C1707.98 39.575 1712.22 40.0883 1716.18 40.515C1720.15 40.9417 1724.15 41.4483 1728.16 42.035C1732.17 42.6083 1735.99 43.1817 1739.6 43.755C1743.21 44.3283 1747.19 44.8883 1751.54 45.435C1755.9 45.9683 1760.21 46.5417 1764.48 47.155C1768.75 47.7817 1772.67 48.275 1776.24 48.635C1779.81 48.995 1783.16 49.3017 1786.28 49.555C1789.41 49.795 1792.67 50.1483 1796.04 50.615C1799.41 51.0817 1802.53 51.555 1805.38 52.035C1808.23 52.515 1812.07 53.235 1816.9 54.195C1821.74 55.155 1825.99 56.0883 1829.66 56.995C1833.33 57.915 1836.93 58.8083 1840.46 59.675C1843.99 60.555 1847.52 61.295 1851.04 61.895C1854.56 62.5083 1857.8 62.8883 1860.76 63.035C1863.73 63.1817 1865.9 63.3883 1867.26 63.655C1868.62 63.9217 1869.9 64.395 1871.1 65.075C1872.3 65.7683 1873.36 66.635 1874.28 67.675C1875.2 68.7017 1875.93 69.855 1876.46 71.135C1877.01 72.415 1877.33 73.7417 1877.44 75.115C1877.53 76.5017 1877.41 77.8617 1877.08 79.195C1876.73 80.5417 1876.19 81.795 1875.44 82.955C1874.68 84.1017 1873.76 85.1083 1872.68 85.975C1871.6 86.8283 1870.41 87.495 1869.1 87.975C1867.79 88.4417 1866.45 88.6883 1865.08 88.715C1863.69 88.7417 1862.34 88.5483 1861.02 88.135C1859.7 87.7217 1858.48 87.1083 1857.36 86.295C1856.24 85.4817 1855.28 84.515 1854.48 83.395C1853.68 82.275 1853.08 81.0483 1852.68 79.715C1852.28 78.395 1852.1 77.0417 1852.14 75.655C1852.19 74.2683 1852.46 72.9283 1852.94 71.635C1853.42 70.3417 1854.1 69.155 1854.98 68.075C1855.85 67.0083 1856.87 66.1017 1858.04 65.355C1859.21 64.6217 1860.47 64.0883 1861.82 63.755C1863.17 63.435 1864.53 63.335 1865.9 63.455C1867.29 63.575 1868.61 63.915 1869.88 64.475C1871.15 65.0217 1872.29 65.7617 1873.32 66.695C1874.35 67.6283 1875.19 68.695 1875.86 69.895C1876.54 71.1083 1877.01 72.395 1877.26 73.755C1877.51 75.115 1877.54 76.4817 1877.34 77.855C1877.14 79.2283 1876.73 80.535 1876.12 81.775C1875.49 83.0017 1874.69 84.095 1873.7 85.055C1872.71 86.0283 1871.6 86.8217 1870.36 87.435C1869.12 88.035 1867.81 88.4283 1866.44 88.615C1865.07 88.7883 1864.38 88.875 1864.38 88.875C1864.38 88.875 1862.51 88.695 1858.78 88.335C1855.05 87.9617 1851.76 87.355 1848.92 86.515C1846.08 85.675 1842.91 84.775 1839.4 83.815C1835.89 82.855 1832.39 81.7283 1828.9 80.435C1825.42 79.155 1821.83 77.9083 1818.14 76.695C1814.46 75.4683 1810.17 74.215 1805.26 72.935C1800.35 71.655 1796.39 70.7283 1793.36 70.155C1790.33 69.5817 1787.24 69.0683 1784.08 68.615C1780.93 68.1617 1777.51 67.6817 1773.82 67.175C1770.14 66.6817 1766.29 66.1617 1762.28 65.615C1758.28 65.055 1753.85 64.6017 1748.98 64.255C1744.11 63.895 1739.97 63.3883 1736.54 62.735C1733.11 62.0817 1729.53 61.475 1725.78 60.915C1722.02 60.3417 1718.11 59.8483 1714.06 59.435C1710.01 59.0083 1705.93 58.5883 1701.82 58.175C1697.71 57.7617 1693.58 57.4817 1689.42 57.335C1685.26 57.1883 1681.03 57.135 1676.72 57.175C1672.41 57.2017 1668.32 57.1483 1664.44 57.015C1660.56 56.8817 1656.79 56.6617 1653.14 56.355C1649.47 56.035 1644.45 55.415 1638.06 54.495C1631.67 53.575 1625.86 52.7883 1620.62 52.135C1615.38 51.4683 1611.35 50.895 1608.52 50.415C1605.68 49.935 1602.81 49.415 1599.9 48.855C1596.99 48.3083 1594.01 47.695 1590.94 47.015C1587.86 46.335 1584.74 45.555 1581.58 44.675C1578.41 43.795 1574.91 42.9017 1571.08 41.995C1567.25 41.075 1562.96 40.175 1558.2 39.295C1553.45 38.415 1548.03 37.5883 1541.92 36.815C1535.81 36.0417 1530.28 35.3617 1525.32 34.775C1520.36 34.175 1514.7 33.555 1508.34 32.915C1501.97 32.275 1495.54 31.5417 1489.06 30.715C1482.58 29.8883 1475.93 29.0683 1469.12 28.255C1462.31 27.4417 1455.09 26.635 1447.48 25.835C1439.85 25.0217 1431.74 24.255 1423.14 23.535C1414.54 22.8017 1405.76 22.2017 1396.8 21.735C1387.84 21.2817 1378.51 20.8217 1368.8 20.355C1359.09 19.8883 1349.09 19.4283 1338.8 18.975C1328.51 18.5217 1317.49 18.095 1305.74 17.695C1293.99 17.295 1283.43 16.935 1274.04 16.615C1264.65 16.3083 1255.12 16.095 1245.44 15.975C1235.76 15.855 1226.41 15.655 1217.4 15.375C1208.4 15.0817 1199.5 14.915 1190.7 14.875C1181.9 14.8217 1173.4 14.7283 1165.2 14.595C1157.01 14.4483 1149.06 14.2083 1141.34 13.875C1133.62 13.5283 1126.39 13.255 1119.64 13.055C1112.89 12.855 1106.18 12.7817 1099.5 12.835C1092.82 12.9017 1085.84 12.975 1078.56 13.055C1071.28 13.1483 1064.71 13.2483 1058.84 13.355C1052.97 13.475 1047.36 13.5617 1042 13.615C1036.64 13.6683 1031.41 13.695 1026.3 13.695C1021.19 13.6817 1015.97 13.7083 1010.64 13.775C1005.32 13.8283 1000.19 13.8417 995.24 13.815C990.307 13.775 985.673 13.6683 981.34 13.495C976.993 13.3217 972.633 13.1283 968.26 12.915C963.887 12.7017 958.807 12.6217 953.02 12.675C947.233 12.7417 941.747 12.7483 936.56 12.695C931.373 12.6417 925.613 12.675 919.28 12.795C912.933 12.9017 907.027 13.0483 901.56 13.235C896.08 13.4083 890.32 13.5283 884.28 13.595C878.24 13.675 871.553 13.795 864.22 13.955C856.887 14.115 849.207 14.3817 841.18 14.755C833.153 15.1417 824.953 15.4617 816.58 15.715C808.193 15.9683 799.273 16.4017 789.82 17.015C780.367 17.6283 770.727 18.3417 760.9 19.155C751.06 19.955 740.887 20.6483 730.38 21.235C719.873 21.8083 708.52 22.435 696.32 23.115C684.133 23.795 671.107 24.5883 657.24 25.495C643.387 26.415 631.007 27.235 620.1 27.955C609.207 28.6883 598.313 29.575 587.42 30.615C576.513 31.6417 565.673 32.6683 554.9 33.695C544.113 34.7217 533.46 35.735 522.94 36.735C512.42 37.735 502.213 38.695 492.32 39.615C482.427 40.5483 472.653 41.4217 463 42.235C453.347 43.0483 444.047 43.7217 435.1 44.255C426.167 44.7883 417.427 45.375 408.88 46.015C400.347 46.6417 391.673 47.3883 382.86 48.255C374.047 49.1217 365.007 49.9283 355.74 50.675C346.473 51.435 338.487 52.0817 331.78 52.615C325.087 53.1617 318.453 53.7817 311.88 54.475C305.307 55.1817 298.587 55.7817 291.72 56.275C284.853 56.7683 278.013 57.3017 271.2 57.875C264.4 58.4483 257.6 59.115 250.8 59.875C243.987 60.635 237.32 61.315 230.8 61.915C224.267 62.5017 217.48 63.195 210.44 63.995C203.4 64.7817 196.18 65.535 188.78 66.255C181.38 66.9617 174.08 67.8217 166.88 68.835C159.68 69.8483 152.273 70.9417 144.66 72.115C137.06 73.275 130.387 74.3683 124.64 75.395C118.907 76.4217 112.953 77.5683 106.78 78.835C100.607 80.1017 94.8333 81.215 89.46 82.175C84.1 83.135 78.7333 84.1417 73.36 85.195C67.9867 86.2617 62.8133 87.1017 57.84 87.715C52.8667 88.3417 48 88.8483 43.24 89.235C38.4667 89.6083 33.68 89.9683 28.88 90.315C24.0933 90.6617 19.2467 90.8217 14.34 90.795C9.44666 90.7683 6.72666 90.7217 6.17999 90.655C5.63333 90.5883 5.09999 90.455 4.57999 90.255C4.07333 90.055 3.58666 89.8017 3.11999 89.495C2.66666 89.175 2.25999 88.8083 1.89999 88.395C1.52666 87.9817 1.21333 87.5283 0.959993 87.035C0.70666 86.555 0.513326 86.0417 0.379993 85.495C0.24666 84.9617 0.179993 84.4217 0.179993 83.875C0.179993 83.3283 0.24666 82.7883 0.379993 82.255C0.513326 81.7083 0.70666 81.195 0.959993 80.715C1.21333 80.2217 1.52666 79.7683 1.89999 79.355C2.25999 78.9417 2.66666 78.575 3.11999 78.255C3.58666 77.9483 4.07333 77.695 4.57999 77.495C5.09999 77.295 5.63333 77.1617 6.17999 77.095C6.72666 77.0283 6.99999 76.995 6.99999 76.995Z" fill="#1E1E1E" />
                        </svg>

                    </span>
                </h1>
                <h2 className="text-xl lg:text-2xl xl:text-3xl text-black/70">
                    Hundreds of meal swipes go unused every semester while students struggle to find affordable and nutritious food.
                    <div className="py-2" />
                    Swipeshare offers a solution by empowering students to support one another.
                </h2>
                <div className="h-8 lg:h-12" />
                <h2 className="text-xl lg:text-2xl xl:text-3xl pb-4 text-[#A98CE4]">
                    Join the waitlist
                </h2>

                <form onSubmit={handleSubmit} className="relative w-full lg:w-96">
                    <input
                        type="email"
                        value={email}
                        onChange={(e) => setEmail(e.target.value)}
                        placeholder="name@email.address"
                        className="px-4 py-2 lg:py-1 pr-12 border border-gray-300 rounded-lg text-gray-700 
                         placeholder-gray-400 focus:outline-none focus:border-[#A98CE4] 
                         w-full"
                        disabled={isSubmitting}
                    />
                    <button
                        type="submit"
                        disabled={isSubmitting || !email}
                        className="absolute right-2 top-1/2 transform -translate-y-1/2 p-2 
                         hover:scale-110 transition-all duration-300 disabled:opacity-50 
                         disabled:cursor-not-allowed overflow-hidden"
                        aria-label="Submit email"
                    >
                        <div className="relative w-6 h-6">
                            {/* Arrow SVG */}
                            <svg
                                className={`w-6 h-6 text-violet-500 absolute transition-all duration-500 ease-out
                                    ${isSubmitting ? 'translate-x-12' : 'translate-x-0'}
                                    ${showSuccess ? '-translate-x-12' : ''}`}
                                fill="none"
                                viewBox="0 0 24 24"
                                stroke="currentColor"
                            >
                                <path
                                    strokeLinecap="round"
                                    strokeLinejoin="round"
                                    strokeWidth={2}
                                    d="M13 7l5 5m0 0l-5 5m5-5H6"
                                />
                            </svg>

                            {/* Success Arrow coming from left */}

                        </div>
                    </button>
                </form>
            </div>

            {/* image */}
            <div>
                <img
                    className="lg:max-w-[50vw] lg:max-h-lvh h-fit w-full max-w-md mx-auto"
                    src={handMockup}
                    alt="hand mockup"
                />
                <div className="absolute bottom-10 left-0 right-0 h-32 bg-gradient-to-t from-white to-transparent pointer-events-none"></div>
            </div>
        </div>
    )
}

export default Hero